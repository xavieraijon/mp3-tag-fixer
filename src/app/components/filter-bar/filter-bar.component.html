<div
  class="sticky top-16 z-40 backdrop-blur-xl bg-white/70 dark:bg-slate-900/70 border border-slate-200/50 dark:border-slate-700/50 rounded-xl p-3 shadow-sm flex flex-wrap gap-3 items-center"
>
  <!-- Search/Filter Input -->
  <div class="flex-1 min-w-[200px] relative group">
    <lucide-icon
      name="search"
      class="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 dark:text-slate-500 group-focus-within:text-indigo-500 dark:group-focus-within:text-indigo-400 transition-colors"
    ></lucide-icon>
    <input
      type="text"
      [ngModel]="filterText()"
      (ngModelChange)="filterText.set($event)"
      placeholder="Filter by filename, artist, title..."
      class="w-full pl-10 pr-10 py-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg focus:outline-none focus:border-indigo-400 dark:focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/20 dark:focus:ring-indigo-400/20 text-slate-800 dark:text-slate-100 placeholder-slate-400 dark:placeholder-slate-500 text-sm transition-all"
    />
    @if (filterText()) {
      <button
        (click)="filterText.set('')"
        class="absolute right-2 top-1/2 -translate-y-1/2 p-1 text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-md transition-all"
        aria-label="Clear filter"
      >
        <lucide-icon name="x" class="w-4 h-4"></lucide-icon>
      </button>
    }
  </div>

  <!-- AI Toggle -->
  <div
    class="flex items-center gap-2 px-3 py-1.5 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg"
  >
    <lucide-icon
      name="sparkles"
      [class]="aiEnabled() ? 'w-4 h-4 text-violet-500' : 'w-4 h-4 text-slate-400 dark:text-slate-500'"
    ></lucide-icon>
    <span class="text-xs font-medium text-slate-600 dark:text-slate-400">AI</span>
    <button
      (click)="aiEnabled.set(!aiEnabled())"
      role="switch"
      [attr.aria-checked]="aiEnabled()"
      [attr.aria-label]="aiEnabled() ? 'Disable AI-powered search' : 'Enable AI-powered search'"
      [class]="
        aiEnabled()
          ? 'relative w-9 h-5 bg-gradient-to-r from-violet-500 to-indigo-500 rounded-full transition-all duration-200'
          : 'relative w-9 h-5 bg-slate-300 dark:bg-slate-600 rounded-full transition-all duration-200'
      "
    >
      <span
        [class]="
          aiEnabled()
            ? 'absolute top-0.5 right-0.5 w-4 h-4 bg-white rounded-full shadow transition-all duration-200'
            : 'absolute top-0.5 left-0.5 w-4 h-4 bg-white rounded-full shadow transition-all duration-200'
        "
      ></span>
    </button>
  </div>

  <!-- Debug Toggle -->
  <div
    class="flex items-center gap-2 px-3 py-1.5 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg"
  >
    <lucide-icon
      name="bug"
      [class]="debugMode() ? 'w-4 h-4 text-amber-500' : 'w-4 h-4 text-slate-400 dark:text-slate-500'"
    ></lucide-icon>
    <span class="text-xs font-medium text-slate-600 dark:text-slate-400">Debug</span>
    <button
      (click)="debugMode.set(!debugMode())"
      role="switch"
      [attr.aria-checked]="debugMode()"
      [attr.aria-label]="debugMode() ? 'Disable debug mode' : 'Enable debug mode'"
      [class]="
        debugMode()
          ? 'relative w-9 h-5 bg-gradient-to-r from-amber-500 to-orange-500 rounded-full transition-all duration-200'
          : 'relative w-9 h-5 bg-slate-300 dark:bg-slate-600 rounded-full transition-all duration-200'
      "
    >
      <span
        [class]="
          debugMode()
            ? 'absolute top-0.5 right-0.5 w-4 h-4 bg-white rounded-full shadow transition-all duration-200'
            : 'absolute top-0.5 left-0.5 w-4 h-4 bg-white rounded-full shadow transition-all duration-200'
        "
      ></span>
    </button>
  </div>

  <!-- Action Buttons -->
  <div class="flex items-center gap-2 flex-wrap">
    <!-- YouTube Button -->
    <app-button (click)="openYoutubeModal.emit()" palette="red" variant="glass" icon="youtube" size="sm">
      YouTube
    </app-button>

    <!-- Process All -->
    <app-button
      (click)="processVisible.emit()"
      [disabled]="!hasFiles()"
      palette="blue"
      variant="glass"
      icon="sparkles"
      size="sm"
    >
      Process
    </app-button>

    <!-- Analyze BPM -->
    <app-button
      (click)="analyzeBpmAll.emit()"
      [disabled]="!hasFiles()"
      palette="emerald"
      variant="glass"
      icon="activity"
      size="sm"
    >
      BPM
    </app-button>

    <!-- Download All -->
    <app-button
      (click)="downloadAll.emit()"
      [disabled]="!hasFiles()"
      palette="primary"
      variant="solid"
      icon="download"
      size="sm"
    >
      Download
    </app-button>

    <!-- Clear List -->
    <app-button
      (click)="clearList.emit()"
      [disabled]="!hasFiles()"
      palette="red"
      variant="ghost"
      shape="square"
      icon="trash-2"
      size="sm"
      title="Clear all files"
    >
    </app-button>
  </div>
</div>
